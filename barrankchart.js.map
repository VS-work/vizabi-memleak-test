{"version":3,"sources":["webpack:///webpack/bootstrap 41a215934a99e689ce31","webpack:///./src/index.js","webpack:///./src/component.js","webpack:///./~/css.escape/css.escape.js","webpack:///./src/styles.scss?ccec","webpack:///./src/template.html","webpack:///(webpack)/buildin/global.js"],"names":["VERSION_INFO","version","build","Vizabi","Tool","extend","init","placeholder","externalModel","name","components","component","model","Component","get","_super","default_model","scales","locale","ui","chart","datawarning","doubtDomain","doubtRange","presentation","versionInfo","utils","axisWithLabelPicker","helpers","iconQuestion","iconset","question","iconWarn","warn","COLOR_BLACKISH","COLOR_WHITEISH","BarRankChart","config","context","template","require","model_expects","type","model_binds","_ready","_readyOnce","onTimeChange","_selectBars","_updateOpacity","_updateDoubtOpacity","_scroll","loadData","draw","_drawColors","xScale","cScale","d3","scaleOrdinal","schemeCategory10","xAxis","marker","getFrame","time","value","values","readyOnce","element","select","header","infoEl","barViewport","barSvg","barContainer","dataWarningEl","tooltipSvg","tooltip","missedPositionsWarningEl","_interact","_createTooltipInteract","on","mouseOver","mouseOut","wScale","scaleLinear","domain","range","tickFormat","axis_x","getTickFormatter","_localeId","id","_entityLabels","_presentation","_formatter","ready","TIMEDIM","getDimension","KEYS","unique","_getAllDimensions","exceptType","KEY","join","dataKeys","getDataKeysPerHook","labelNames","getLabelHookNames","markerKeys","getKeys","resize","_this","translator","getTFunction","xAxisValues","valuesCount","Object","keys","length","nullValuesCount","sortedEntities","_sortByIndicator","parent","findChildByName","markerID","alignX","alignY","updateView","toggle","getScale","copy","color","setIcon","attr","append","text","classed","conceptPropsX","getConceptprops","style","Number","Boolean","description","sourceLink","pin","rect","getBBox","ctx","makeAbsoluteContext","farthestViewportElement","coord","x","y","height","setHook","show","setPos","hide","force","time_1","duration","playing","delayAnimations","drawAxes","drawData","profiles","small","margin","top","right","left","bottom","headerMargin","infoElHeight","infoElMargin","barHeight","barMargin","barRectMargin","barValueMargin","scrollMargin","medium","large","presentationProfileChanges","activeProfile","getActiveProfile","parseInt","width","headerTitle","unit","headerTitleText","rightEdgeOfLeftText","node","headerTitleBBox","titleTx","titleTy","headerInfo","infoTx","infoTy","headerTotal","transition","delay","formatDate","interrupt","getLayoutProfile","headerTotalBBox","totalTx","totalTy","warningBBox","_createAndDeleteBars","selectAll","data","d","presentationModeChanged","entitiesCountChanged","_entitiesCount","_resizeSvg","limits","getLimits","which","ltr","Math","abs","max","min","hasNegativeValues","rightEdge","_getWidestLabelWidth","scaleType","shift","barWidth","isLtrValue","labelAnchor","valueAnchor","labelX","barX","valueX","isLabelBig","forEach","bar","isNew","changedValue","barLabel","label","labelSmall","barRect","barValue","barRank","i","rank","changedWidth","ease","easeLinear","changedIndex","self","_getBarPosition","index","follow","empty","datum","yPos","scrollTo","tween","entity","_scrollTopTween","_getLabelText","map","key","updatedBars","localeChanged","exit","remove","enter","each","substring","selectedLabel","size","labelWidth","labelSmallWidth","assign","isSelected","getKey","_id","highlightMarker","clearHighlighted","selectMarker","merge","big","widthKey","labelKey","reduce","a","b","colorValue","isColorValid","fillColor","String","_getColor","strokeColor","_getDarkerColor","rgb","darker","scrollTop","interpolateNumber","t","_entities","dataKey","cached","formattedValue","sort","Infinity","entities","selected","selectedBar","OPACITY_HIGHLIGHT_DEFAULT","highlight","OPACITY_HIGHLIGHT_DIM","opacityHighlightDim","OPACITY_SELECT_DIM","opacitySelectDim","OPACITY_REGULAR","opacityRegular","someHighlighted","someSelected","isHighlighted","opacity","getUTCFullYear","toString","contextElement","sourceElement","evt","event","mouse","sourceElementBBox","coordInSource","_setTooltip","target","tap","tooltipText","contentBBox"],"mappings":"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,CAEQ,QAFR,EAEkB6M,YAAYzL,MAAZ,GAAqB,GAFvC,EAGGpB,IAHH,CAGQ,GAHR,EAGa,CAAC6M,YAAYxJ,KAAb,GAAqB,CAHlC,EAIGrD,IAJH,CAIQ,GAJR,EAIa,CAAC6M,YAAYzL,MAAb,GAAsB,IAJnC,EAKGpB,IALH,CAKQ,IALR,EAKc6M,YAAYzL,MAAZ,GAAqB,GALnC,EAMGpB,IANH,CAMQ,IANR,EAMc6M,YAAYzL,MAAZ,GAAqB,GANnC;AAQD,GA9BD,MA8BO;AACL,SAAK7E,OAAL,CAAa4D,OAAb,CAAqB,YAArB,EAAmC,IAAnC;AACD;AACF,CAh3BkB,0BAArB;;kBAm3BenG,Y;;;;;;AC73Bf;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC;;;;;;;;ACzGD,yC;;;;;;ACAA,s7B;;;;;;ACAA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C","file":"barrankchart.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 41a215934a99e689ce31","import \"./styles.scss\";\nimport component from \"./component\";\n\nconst VERSION_INFO = { version: __VERSION, build: __BUILD };\n\nexport default Vizabi.Tool.extend(\"BarRankChart\", {\n\n  // Run when the tool is created\n  init: function (placeholder, externalModel) {\n\n    this.name = \"barrankchart\";\n\n    this.components = [{\n      component: component,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.marker\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.time\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datawarning\"),\n      placeholder: \".vzb-tool-datawarning\",\n      model: [\"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    // constructor is the same as any tool\n    this._super(placeholder, externalModel);\n  },\n\n  /**\n   * Determines the default model of this tool\n   */\n  default_model: {\n    \"state\": {\n      \"time\": {\n        \"autoconfig\": {\n          \"type\": \"time\"\n        }\n      },\n      \"entities\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"entities_colorlegend\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"marker\": {\n        \"space\": [\"entities\", \"time\"],\n        \"axis_x\": {\n          \"use\": \"indicator\",\n          \"autoconfig\": {\n            \"type\": \"measure\"\n          },\n          \"allow\": { scales: [\"linear\", \"log\"] }\n        },\n        // \"axis_y\": {\n        //   \"use\": \"property\",\n        //   \"allow\": { scales: [\"ordinal\", \"nominal\"] },\n        //   \"autoconfig\": {\n        //     \"type\": \"entity_domain\"\n        //   }\n        // },\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        },\n        \"color\": {\n          \"syncModels\": [\"marker_colorlegend\"],\n          \"autoconfig\": {}\n        }\n      },\n      \"marker_colorlegend\": {\n        \"space\": [\"entities_colorlegend\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"which\": \"name\"\n        },\n        \"hook_rank\": {\n          \"use\": \"property\",\n          \"which\": \"rank\"\n        },\n        \"hook_geoshape\": {\n          \"use\": \"property\",\n          \"which\": \"shape_lores_svg\"\n        }\n      }\n    },\n    locale: {},\n    ui: {\n      chart: {},\n      datawarning: {\n        doubtDomain: [],\n        doubtRange: []\n      },\n      \"buttons\": [\"colors\", \"find\", \"moreoptions\", \"fullscreen\", \"presentation\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import cssEscape from \"css.escape\";\nconst utils = Vizabi.utils;\n\nconst axisWithLabelPicker = Vizabi.helpers['d3.axisWithLabelPicker'];\nconst iconQuestion = Vizabi.iconset.question;\nconst iconWarn = Vizabi.iconset.warn;\n\nconst COLOR_BLACKISH = \"rgb(51, 51, 51)\";\nconst COLOR_WHITEISH = \"rgb(253, 253, 253)\";\n\nconst BarRankChart = Vizabi.Component.extend(\"barrankchart\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init(config, context) {\n\n    this.name = 'barrankchart';\n    this.template = require('./template.html');\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    this.model_binds = {\n      'change:time.value': () => {\n        // TODO: review this after vizabi#2450 will be fixed\n        if (!this.model._ready) return;\n\n        if (this._readyOnce) {\n          this.onTimeChange();\n        }\n      },\n      'change:marker.select': () => {\n        if (this._readyOnce) {\n          this._selectBars();\n          this._updateOpacity();\n          this._updateDoubtOpacity();\n          this._scroll();\n        }\n      },\n      'change:marker.axis_x.scaleType': () => {\n        if (this._readyOnce) {\n          if (this.loadData()) {\n            this.draw(true);\n          }\n        }\n      },\n      'change:marker.color.palette': () => {\n        this._drawColors();\n      },\n      'change:marker.highlight': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacitySelectDim': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacityRegular': () => {\n        this._updateOpacity();\n      },\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    // set up the scales\n    this.xScale = null;\n    this.cScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // set up the axes\n    this.xAxis = axisWithLabelPicker(\"bottom\");\n  },\n\n  onTimeChange() {\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        if (this.loadData()) {\n          this.draw();\n        }\n      }\n    });\n  },\n\n  /**\n   * DOM and model are ready\n   */\n  readyOnce() {\n    this.element = d3.select(this.element);\n\n    // reference elements\n    //this.graph = this.element.select('.vzb-br-graph');\n    //this.yearEl = this.element.select('.vzb-br-year');\n    //this.year = new DynamicBackground(this.yearEl);\n    this.header = this.element.select('.vzb-br-header');\n    this.infoEl = this.element.select('.vzb-br-axis-info');\n    this.barViewport = this.element.select('.vzb-br-barsviewport');\n    this.barSvg = this.element.select('.vzb-br-bars-svg');\n    this.barContainer = this.element.select('.vzb-br-bars');\n    this.dataWarningEl = this.element.select('.vzb-data-warning');\n    this.tooltipSvg = this.element.select(\".vzb-br-tooltip-svg\");\n    this.tooltip = this.element.select(\".vzb-br-tooltip\");\n    this.missedPositionsWarningEl = this.element.select('.vzb-data-warning-missed-positions');\n    const _interact = this._createTooltipInteract(this.element, this.missedPositionsWarningEl);\n    this.missedPositionsWarningEl\n      .on(\"mouseover\", _interact.mouseOver)\n      .on(\"mouseout\", _interact.mouseOut);\n    this.wScale = d3.scaleLinear()\n      .domain(this.model.ui.datawarning.doubtDomain)\n      .range(this.model.ui.datawarning.doubtRange);\n\n    // set up formatters\n    this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter());\n\n    this._localeId = this.model.locale.id;\n    this._entityLabels = {};\n    this._presentation = !this.model.ui.presentation;\n    this._formatter = this.model.marker.axis_x.getTickFormatter();\n\n    this.ready();\n\n    this._selectBars();\n\n  },\n\n  /**\n   * Both model and DOM are ready\n   */\n  ready() {\n    this.TIMEDIM = this.model.time.getDimension();\n    this.KEYS = utils.unique(this.model.marker._getAllDimensions({ exceptType: \"time\" }));\n    this.KEY = this.KEYS.join(\",\");\n    this.dataKeys = this.model.marker.getDataKeysPerHook();\n    this.labelNames = this.model.marker.getLabelHookNames();\n\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        this.markerKeys = this.model.marker.getKeys();\n        if (this.loadData()) {\n          this.draw(true);\n          this._updateOpacity();\n          this._drawColors();\n        }\n      }\n    });\n  },\n\n  resize() {\n    this.draw(true);\n    this._drawColors();\n  },\n\n  loadData() {\n    const _this = this;\n\n    this.translator = this.model.locale.getTFunction();\n    // sort the data (also sets this.total)\n    const xAxisValues = this.values.axis_x;\n    const valuesCount = Object.keys(xAxisValues).length;\n    if (!valuesCount) return false;\n\n    this.nullValuesCount = 0;\n    this.sortedEntities = this._sortByIndicator(xAxisValues, this.dataKeys.axis_x);\n\n    this.header\n      .select('.vzb-br-title')\n      .select('text')\n      .on('click', () =>\n        this.parent\n          .findChildByName('gapminder-treemenu')\n          .markerID('axis_x')\n          .alignX('left')\n          .alignY('top')\n          .updateView()\n          .toggle()\n      );\n\n    // new scales and axes\n    this.xScale = this.model.marker.axis_x.getScale().copy();\n    this.cScale = this.model.marker.color.getScale();\n\n    utils.setIcon(this.dataWarningEl, iconWarn)\n      .select('svg')\n      .attr('width', 0).attr('height', 0);\n\n    this.dataWarningEl.append('text')\n      .text(this.translator('hints/dataWarning'));\n\n    this.dataWarningEl\n      .on('click', () => this.parent.findChildByName('gapminder-datawarning').toggle())\n      .on('mouseover', () => this._updateDoubtOpacity(1))\n      .on('mouseout', () => this._updateDoubtOpacity());\n\n    this.missedPositionsWarningEl\n      .classed(\"vzb-hidden\", (1 - this.nullValuesCount / valuesCount) > 0.85)\n      .select(\"text\")\n      .attr(\"data-text\", this.translator(\"hints/barrank/missedPositionsTooltip\"))\n      .text(this.translator(\"hints/barrank/missedPositionsWarning\"))\n\n    const conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.infoEl, iconQuestion)\n      .select('svg').attr('width', 0).attr('height', 0)\n      .style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.infoEl.on('click', () => {\n      this.parent.findChildByName('gapminder-datanotes').pin();\n    });\n\n    this.infoEl.on('mouseover', function() {\n      const rect = this.getBBox();\n      const ctx = utils.makeAbsoluteContext(this, this.farthestViewportElement);\n      const coord = ctx(rect.x - 10, rect.y + rect.height + 10);\n      _this.parent.findChildByName('gapminder-datanotes')\n        .setHook('axis_x')\n        .show()\n        .setPos(coord.x, coord.y);\n    });\n\n    this.infoEl.on('mouseout', () => {\n      _this.parent.findChildByName('gapminder-datanotes').hide();\n    });\n\n    return true;\n  },\n\n  draw(force = false) {\n    this.time_1 = this.time == null ? this.model.time.value : this.time;\n    this.time = this.model.time.value;\n    //smooth animation is needed when playing, except for the case when time jumps from end to start\n    const duration = this.model.time.playing && (this.time - this.time_1 > 0) ? this.model.time.delayAnimations : 0;\n\n    //return if drawAxes exists with error\n    if (this.drawAxes(duration, force)) return;\n    this.drawData(duration, force);\n  },\n\n  /*\n   * draw the chart/stage\n   */\n  drawAxes(duration = 0) {\n    const profiles = {\n      small: {\n        margin: { top: 60, right: 20, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 18,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 20,\n      },\n      medium: {\n        margin: { top: 60, right: 25, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 21,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      },\n      large: {\n        margin: { top: 60, right: 30, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 28,\n        barMargin: 4,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      }\n    };\n\n    const presentationProfileChanges = {\n      medium: {\n        margin: { top: 60, right: 30, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 25,\n        infoElMargin: 10,\n        barHeight: 25,\n        barMargin: 6\n      },\n      large: {\n        margin: { top: 60, right: 35, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 10,\n        barHeight: 30,\n        barMargin: 6\n      }\n    };\n\n    this.activeProfile = this.getActiveProfile(profiles, presentationProfileChanges);\n\n    const {\n      margin,\n      headerMargin,\n      infoElHeight,\n      infoElMargin,\n    } = this.activeProfile;\n\n    this.height = parseInt(this.element.style('height'), 10) || 0;\n    this.width = parseInt(this.element.style('width'), 10) || 0;\n\n    if (!this.height || !this.width) return utils.warn('Dialog resize() abort: vizabi container is too little or has display:none');\n\n    this.barViewport\n      .style('height', `${this.height - margin.bottom - margin.top}px`);\n\n    // header\n    this.header.attr('height', margin.top);\n    const headerTitle = this.header.select('.vzb-br-title');\n\n    // change header titles for new data\n    const { name, unit } = this.model.marker.axis_x.getConceptprops();\n\n    const headerTitleText = headerTitle\n      .select('text');\n\n    if (unit) {\n      headerTitleText.text(`${name}, ${unit}`);\n\n      const rightEdgeOfLeftText = headerMargin.left\n        + headerTitle.node().getBBox().width\n        + infoElMargin\n        + infoElHeight;\n\n      if (rightEdgeOfLeftText > this.width - headerMargin.right) {\n        headerTitleText.text(name);\n      }\n    } else {\n      headerTitleText.text(name);\n    }\n\n    const headerTitleBBox = headerTitle.node().getBBox();\n\n    const titleTx = headerMargin.left;\n    const titleTy = headerMargin.top + headerTitleBBox.height;\n    headerTitle\n      .attr('transform', `translate(${titleTx}, ${titleTy})`);\n\n    const headerInfo = this.infoEl;\n\n    headerInfo.select('svg')\n      .attr('width', `${infoElHeight}px`)\n      .attr('height', `${infoElHeight}px`);\n\n    const infoTx = titleTx + headerTitle.node().getBBox().width + infoElMargin;\n    const infoTy = headerMargin.top + infoElHeight / 4;\n    headerInfo.attr('transform', `translate(${infoTx}, ${infoTy})`);\n\n\n    const headerTotal = this.header.select('.vzb-br-total');\n\n    if (duration) {\n      headerTotal.select('text')\n        .transition('text')\n        .delay(duration)\n        .text(this.model.time.formatDate(this.time));\n    } else {\n      headerTotal.select('text')\n        .interrupt()\n        .text(this.model.time.formatDate(this.time));\n    }\n    headerTotal.style('opacity', Number(this.getLayoutProfile() !== 'large'));\n\n    const headerTotalBBox = headerTotal.node().getBBox();\n\n    const totalTx = this.width - headerMargin.right - headerTotalBBox.width;\n    const totalTy = headerMargin.top + headerTotalBBox.height;\n    headerTotal\n      .attr('transform', `translate(${totalTx}, ${totalTy})`)\n      .classed('vzb-transparent', headerTitleBBox.width + headerTotalBBox.width + 10 > this.width);\n\n    this.element.select('.vzb-data-warning-svg')\n      .style('height', `${margin.bottom}px`);\n\n\n    const warningBBox = this.dataWarningEl.select('text').node().getBBox();\n    this.dataWarningEl\n      .attr('transform', `translate(${this.width - margin.right - warningBBox.width}, ${warningBBox.height})`);\n\n    this.dataWarningEl\n      .select('svg')\n      .attr('width', warningBBox.height)\n      .attr('height', warningBBox.height)\n      .attr('x', -warningBBox.height - 5)\n      .attr('y', -warningBBox.height + 1);\n\n    this.missedPositionsWarningEl\n      .attr('transform', `translate(${this.width - margin.right - warningBBox.width - warningBBox.height * 3}, ${warningBBox.height})`);\n\n    this._updateDoubtOpacity();\n  },\n\n  drawData(duration = 0, force = false) {\n    const KEY = this.KEY;\n    // update the shown bars for new data-set\n    this._createAndDeleteBars(\n      this.barContainer.selectAll('.vzb-br-bar')\n        .data(this.sortedEntities, d => d[KEY])\n    );\n\n\n    const { presentation } = this.model.ui;\n    const presentationModeChanged = this._presentation !== presentation;\n\n    if (presentationModeChanged) {\n      this._presentation = presentation;\n    }\n\n\n    const entitiesCountChanged = typeof this._entitiesCount === 'undefined'\n      || this._entitiesCount !== this.sortedEntities.length;\n\n    if (presentationModeChanged || entitiesCountChanged) {\n      if (entitiesCountChanged) {\n        this._entitiesCount = this.sortedEntities.length;\n      }\n    }\n\n    this._resizeSvg();\n    this._scroll(duration);\n    this._drawColors();\n\n\n    const { barRectMargin, barValueMargin, scrollMargin, margin } = this.activeProfile;\n    const { axis_x } = this.model.marker;\n    const limits = axis_x.getLimits(axis_x.which);\n    const ltr = Math.abs(limits.max) >= Math.abs(limits.min);\n    const hasNegativeValues = ltr ? limits.min < 0 : limits.max > 0;\n\n\n    const rightEdge = (\n        this.width\n        - margin.right\n        - margin.left\n        - barRectMargin\n        - scrollMargin\n        - (hasNegativeValues ? 0 : this._getWidestLabelWidth())\n      ) / (hasNegativeValues ? 2 : 1);\n\n    this.xScale\n      .range([0, rightEdge]);\n    \n    if (this.model.marker.axis_x.scaleType !== \"log\") {\n      this.xScale\n        .domain([0, Math.max(...this.xScale.domain())]);\n    }\n\n    const shift = hasNegativeValues ? rightEdge : this._getWidestLabelWidth();\n\n    const barWidth = (value) => this.xScale(value);\n    const isLtrValue = value => ltr ? value >= 0 : value > 0;\n\n    const labelAnchor = value => isLtrValue(value) ? 'end' : 'start';\n    const valueAnchor = value => isLtrValue(value) ? 'start' : 'end';\n\n    const labelX = value => isLtrValue(value) ?\n      (margin.left + shift) :\n      (this.width - shift - scrollMargin - margin.right);\n\n    const barX = value => isLtrValue(value) ?\n      (labelX(value) + barRectMargin) :\n      (labelX(value) - barRectMargin);\n\n    const valueX = value => isLtrValue(value) ?\n      (barX(value) + barValueMargin) :\n      (barX(value) - barValueMargin);\n\n    const isLabelBig = (this._getWidestLabelWidth(true) + (ltr ? margin.left : margin.right)) < shift;\n    this.sortedEntities.forEach((bar) => {\n      const { value } = bar;\n\n      if (force || presentationModeChanged || bar.isNew || bar.changedValue) {\n        bar.barLabel\n          .attr('x', labelX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', labelAnchor(value))\n          .text(isLabelBig ? bar.label : bar.labelSmall);\n\n        bar.barRect\n          .attr('rx', this.activeProfile.barHeight / 4)\n          .attr('ry', this.activeProfile.barHeight / 4)\n          .attr('height', this.activeProfile.barHeight);\n\n        bar.barValue\n          .attr('x', valueX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', valueAnchor(value));\n\n        bar.barRank          \n          .text((d, i) => value || value === 0 ? \"#\" + (d.rank) : \"\")\n          .attr('dx', \".5em\")\n          .attr('y', this.activeProfile.barHeight / 2);\n      }\n\n      if (force || bar.changedWidth || presentationModeChanged) {\n        const width = Math.max(0, value && barWidth(Math.abs(value))) || 0;\n\n        if (force || bar.changedValue) {\n          bar.barValue\n            .text(this._formatter(value) || this.translator('hints/nodata'));\n        }\n\n        if (force || bar.changedWidth || presentationModeChanged) {\n          bar.barRect\n            .transition().duration(duration).ease(d3.easeLinear)\n            .attr('width', width);\n          bar.barRank\n            .transition().duration(duration).ease(d3.easeLinear)\n            .attr('x', labelX(value) + Math.max(width, bar.barValue.node().getBBox().width + 10));\n        }\n\n        bar.barRect\n          .attr('x', barX(value) - (value < 0 ? width : 0));\n      }\n\n      if (force || bar.changedIndex || presentationModeChanged) {\n        !duration && bar.self.interrupt();\n        (duration ? bar.self.transition().duration(duration).ease(d3.easeLinear) : bar.self)\n          .attr('transform', `translate(0, ${this._getBarPosition(bar.index)})`);\n        bar.barRank          \n          .text((d, i) => value || value === 0 ? \"#\" + (d.rank) : \"\");\n      }\n    });\n  },\n\n  _resizeSvg() {\n    const { barHeight, barMargin } = this.activeProfile;\n    this.barSvg.attr('height', `${(barHeight + barMargin) * this.sortedEntities.length}px`);\n  },\n\n  _scroll(duration = 0) {\n    const follow = this.barContainer.select('.vzb-selected');\n    if (!follow.empty()) {\n      const d = follow.datum();\n      const yPos = this._getBarPosition(d.index);\n\n      const { margin } = this.activeProfile;\n      const height = this.height - margin.top - margin.bottom;\n\n      const scrollTo = yPos - (height + this.activeProfile.barHeight) / 2;\n      this.barViewport.transition().duration(duration)\n        .tween('scrollfor' + d.entity, this._scrollTopTween(scrollTo));\n    }\n  },\n\n  _getLabelText(values, labelNames, d) {\n    return this.KEYS.map(key => values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key]).join(\", \");\n  },\n\n  _createAndDeleteBars(updatedBars) {\n    const _this = this;\n    const KEYS = this.KEYS;\n    const dataKeys = this.dataKeys;\n\n    // TODO: revert this commit after fixing https://github.com/vizabi/vizabi/issues/2450\n    const [entity] = this.sortedEntities;\n    if (!this._entityLabels[entity.entity]) {\n      this._entityLabels[entity.entity] = entity.label;\n    }\n\n    const label = this._getLabelText(this.values, this.labelNames, entity.entity)\n    const localeChanged = this._entityLabels[entity.entity] !== label\n      && this.model.locale.id !== this._localeId;\n\n    if (localeChanged) {\n      this._localeId = this.model.locale.id;\n      this._entityLabels[entity.entity] = label;\n    }\n\n    // remove groups for entities that are gone\n    updatedBars.exit().remove();\n\n    // make the groups for the entities which were not drawn yet (.data.enter() does this)\n    updatedBars = (localeChanged ? updatedBars : updatedBars.enter().append('g'))\n      .each(function(d) {\n        const self = d3.select(this);\n\n        const label = d.label;\n        const labelSmall = label.length < 12 ? label : `${label.substring(0, 9)}...`;//\n\n        const selectedLabel = self.select('.vzb-br-label');\n        const barLabel = selectedLabel.size() ?\n          selectedLabel :\n          self.append('text')\n            .attr('class', 'vzb-br-label')\n            .attr('dy', '.325em');\n\n        const labelWidth = barLabel.text(label).node().getBBox().width;\n        const labelSmallWidth = barLabel.text(labelSmall).node().getBBox().width;\n\n        Object.assign(d, {\n          labelWidth,\n          labelSmallWidth,\n          labelSmall,\n          barLabel,\n        });\n\n        if (!localeChanged) {\n          self\n            .attr('class', 'vzb-br-bar')\n            .classed('vzb-selected', _this.model.marker.isSelected(d.entity))\n            .attr('id', `vzb-br-bar-${utils.getKey(d.entity, KEYS)}-${_this._id}`)\n            .on('mousemove', d => _this.model.marker.highlightMarker(d.entity))\n            .on('mouseout', () => _this.model.marker.clearHighlighted())\n            .on('click', d => {\n              _this.model.marker.selectMarker(d.entity);\n            });\n\n          const barRect = self.append('rect')\n            .attr('stroke', 'transparent');\n\n          const barValue = self.append('text')\n            .attr('class', 'vzb-br-value')\n            .attr('dy', '.325em');\n\n          const barRank = self.append('text')\n            .attr('class', 'vzb-br-rank')\n            .attr('dy', '.325em');\n\n          Object.assign(d, {\n            self,\n            isNew: true,\n            barRect,\n            barValue,\n            barRank\n          });\n        }\n      })\n      .merge(updatedBars);\n  },\n\n  _getWidestLabelWidth(big = false) {\n    const widthKey = big ? 'labelWidth' : 'labelSmallWidth';\n    const labelKey = big ? 'label' : 'labelSmall';\n\n    const bar = this.sortedEntities\n      .reduce((a, b) => a[widthKey] < b[widthKey] ? b : a);\n\n    const text = bar.barLabel.text();\n    const width = bar.barLabel.text(bar[labelKey]).node().getBBox().width;\n    bar.barLabel.text(text);\n\n    return width;\n  },\n\n  _drawColors() {\n    const _this = this;\n    const dataKeys = this.dataKeys;\n\n    this.barContainer.selectAll('.vzb-br-bar>rect')\n      .each(function({ entity }) {\n        const rect = d3.select(this);\n\n        const colorValue = _this.values.color[utils.getKey(entity, dataKeys.color)];\n        const isColorValid = colorValue || colorValue === 0;\n\n        const fillColor = isColorValid ? String(_this._getColor(colorValue)) : COLOR_WHITEISH;\n        const strokeColor = isColorValid ? 'transparent' : COLOR_BLACKISH;\n\n        rect.style('fill') !== fillColor && rect.style('fill', fillColor);\n        rect.style('stroke') !== strokeColor && rect.style('stroke', strokeColor);\n      });\n\n    this.barContainer.selectAll('.vzb-br-bar>text')\n      .style('fill', ({ entity }) => this._getDarkerColor(this.values.color[utils.getKey(entity, dataKeys.color)] || null));\n  },\n\n  _getColor(value) {\n    return d3.rgb(this.cScale(value));\n  },\n\n  _getDarkerColor(d) {\n    return this._getColor(d).darker(2);\n  },\n\n\n  /**\n   * DATA HELPER FUNCTIONS\n   */\n\n  _scrollTopTween(scrollTop) {\n    return function() {\n      const node = this, i = d3.interpolateNumber(this.scrollTop, scrollTop);\n      return function(t) {\n        node.scrollTop = i(t);\n      };\n    };\n  },\n\n  _getBarPosition(i) {\n    return (this.activeProfile.barHeight + this.activeProfile.barMargin) * i;\n  },\n\n  _entities: {},\n\n  _sortByIndicator(values, dataKey) {\n    const KEYS = this.KEYS;\n    const KEY = this.KEY;\n    const dataKeys = this.dataKeys;\n    return this.markerKeys.map(entity => {\n      const key = utils.getKey(entity, KEYS);\n      const cached = this._entities[key];\n      const value = values[utils.getKey(entity, dataKey)];\n      !value && value !== 0 && this.nullValuesCount++;\n      const label = this._getLabelText(this.values, this.labelNames, entity);\n      const formattedValue = this._formatter(value);\n\n      if (cached) {\n        return Object.assign(cached, {\n          value,\n          label,\n          formattedValue,\n          changedValue: formattedValue !== cached.formattedValue,\n          changedWidth: value !== cached.value,\n          isNew: false\n        });\n      }\n\n      return this._entities[key] = {\n        entity,\n        value,\n        label,\n        formattedValue,\n        [this.KEY]: key,\n        changedValue: true,\n        changedWidth: true,\n        isNew: true\n      };\n    }).sort(({ value: a }, { value: b }) => (b || (b === 0 ? 0 : -Infinity)) - (a || (a === 0 ? 0 : -Infinity)))\n      .map((entity, index, entities) => \n        Object.assign(entity, {\n          index: index,\n          rank: !index || entities[index - 1].formattedValue !== entity.formattedValue ? index + 1 : entities[index - 1].rank,\n          changedIndex: index !== entity.index\n        }));\n  },\n\n  _selectBars() {\n    const KEYS = this.KEYS;\n    const selected = this.model.marker.select;\n\n    // unselect all bars\n    this.barContainer.classed('vzb-dimmed-selected', false);\n    this.barContainer.selectAll('.vzb-br-bar.vzb-selected').classed('vzb-selected', false);\n\n    // select the selected ones\n    if (selected.length) {\n      this.barContainer.classed('vzb-dimmed-selected', true);\n      selected.forEach(selectedBar => {\n        this.barContainer\n          .select(`#vzb-br-bar-${cssEscape(utils.getKey(selectedBar, KEYS))}-${this._id}`)\n          .classed('vzb-selected', true);\n      });\n    }\n\n  },\n\n  _updateOpacity() {\n    const { model: { marker } } = this;\n\n    const OPACITY_HIGHLIGHT_DEFAULT = 1;\n    const {\n      highlight,\n      select,\n\n      opacityHighlightDim: OPACITY_HIGHLIGHT_DIM,\n      opacitySelectDim: OPACITY_SELECT_DIM,\n      opacityRegular: OPACITY_REGULAR,\n    } = marker;\n\n    const [\n      someHighlighted,\n      someSelected\n    ] = [\n      highlight.length > 0,\n      select.length > 0\n    ];\n\n    this.barContainer.selectAll('.vzb-br-bar')\n      .style('opacity', d => {\n        if (someHighlighted && marker.isHighlighted(d.entity)) {\n          return OPACITY_HIGHLIGHT_DEFAULT;\n        }\n\n        if (someSelected) {\n          return marker.isSelected(d.entity) ? OPACITY_REGULAR : OPACITY_SELECT_DIM;\n        }\n\n        if (someHighlighted) {\n          return OPACITY_HIGHLIGHT_DIM;\n        }\n\n        return OPACITY_REGULAR;\n      });\n  },\n\n  _updateDoubtOpacity(opacity) {\n    this.dataWarningEl.style('opacity',\n      opacity || (\n        !this.model.marker.select.length ?\n          this.wScale(+this.model.time.value.getUTCFullYear().toString()) :\n          1\n      )\n    );\n  },\n\n  _getLabelText(values, labelNames, d) {\n    return this.KEYS.map(key => values[labelNames[key]] ? values[labelNames[key]][d[key]] : d[key]).join(\", \");    \n  },\n\n  _createTooltipInteract(contextElement, sourceElement) {\n    const _this = this;\n    return {\n      mouseOver() {\n        const evt = d3.event;\n        const mouse = d3.mouse(contextElement.node());\n        const sourceElementBBox = sourceElement.node().getBBox();\n        const coordInSource= d3.mouse(sourceElement.node());\n        _this.tooltipSvg.classed(\"vzb-hidden\", false);\n        _this._setTooltip(d3.select(evt.target).attr(\"data-text\"), \n          mouse[0] - coordInSource[0], \n          mouse[1] - coordInSource[1] + sourceElementBBox.y);\n      },\n      mouseOut() {\n        _this.tooltipSvg.classed(\"vzb-hidden\", true);\n        _this._setTooltip();\n      },\n      tap() {\n\n      }\n    };\n  },\n\n  _setTooltip(tooltipText, x, y) {\n    if (tooltipText) {\n\n      //position tooltip\n      this.tooltip.classed(\"vzb-hidden\", false)\n      //.attr(\"style\", \"left:\" + (mouse[0] + 50) + \"px;top:\" + (mouse[1] + 50) + \"px\")\n        .selectAll(\"text\")\n        .text(tooltipText);\n\n      const contentBBox = this.tooltip.select(\"text\").node().getBBox();\n      if (x - contentBBox.width < 0) {\n        x = contentBBox.width + 5; // corrective to the block Radius and text padding\n      } else {\n        x -= 5; // corrective to the block Radius and text padding\n      }\n      if (y - contentBBox.height < 0) {\n        y += contentBBox.height;\n      } else {\n        y -= 11; // corrective to the block Radius and text padding\n      }\n\n      this.tooltip.attr(\"transform\", \"translate(\" + x + \",\" + y + \")\");\n\n      this.tooltip.selectAll(\"rect\")\n        .attr(\"width\", contentBBox.width + 8)\n        .attr(\"height\", contentBBox.height * 1.2)\n        .attr(\"x\", -contentBBox.width - 4)\n        .attr(\"y\", -contentBBox.height * 0.85)\n        .attr(\"rx\", contentBBox.height * 0.2)\n        .attr(\"ry\", contentBBox.height * 0.2);\n\n    } else {\n      this.tooltip.classed(\"vzb-hidden\", true);\n    }\n  }\n});\n\nexport default BarRankChart;\n\n\n\n// WEBPACK FOOTER //\n// ./src/component.js","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: theres no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, []\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), []\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), []\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, []\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), []\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css.escape/css.escape.js\n// module id = 2\n// module chunks = 0 1","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles.scss\n// module id = 3\n// module chunks = 0 1","module.exports = \"<!-- Bar Chart Component -->\\n<div class=\\\"vzb-barrankchart\\\">\\n  <svg class=\\\"vzb-br-header\\\">\\n    <g class=\\\"vzb-br-title\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-total\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-axis-info vzb-noexport\\\"></g>\\n  </svg>\\n\\n  <div class=\\\"vzb-br-barsviewport vzb-dialog-scrollable\\\">\\n    <svg class=\\\"vzb-br-bars-svg vzb-export\\\">\\n      <g class=\\\"vzb-br-bars\\\"></g>\\n    </svg>\\n  </div>\\n\\n  <svg class=\\\"vzb-data-warning-svg\\\">\\n    <g class=\\\"vzb-data-warning vzb-noexport\\\">\\n      <svg></svg>\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-data-warning vzb-data-warning-missed-positions\\\">\\n      <text></text>\\n    </g>\\n  </svg>\\n\\n  <svg class=\\\"vzb-br-tooltip-svg vzb-hidden\\\">\\n    <g class=\\\"vzb-br-tooltip vzb-hidden\\\">\\n      <rect class=\\\"vzb-tooltip-border\\\"></rect>\\n      <text class=\\\"vzb-tooltip-text\\\"></text>\\n    </g>\\n  </svg>\\n</div>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/template.html\n// module id = 4\n// module chunks = 0 1","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 5\n// module chunks = 0 1"],"sourceRoot":""}